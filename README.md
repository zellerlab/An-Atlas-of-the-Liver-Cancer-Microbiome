# An Atlas of the Human Liver Cancer Microbiome
(Rahbari, Springer, Zwang et al.)

This repository contains all scripts to reproduce the results and figures presented in the manuscript "An Atlas of the Human Liver Cancer Microbiome".

## Raw data access
The required input data will be made public on Zenodo upon publication (https://zenodo.org/).
Until then it can be requested via e-mail to fabian.springer[at]embl.de.

## Instructions to run: 
1) Clone the repository and put the input data into `data/raw/` and the metadata into `data/metadata/`.
2) Prepare the datasets for analysis by running the scripts in `src/prepare_data/` in the order given by their filenames.
3) Run the analysis via the scripts in in `src/analysis/`.
4) Generate figures from `src/plotting/`.
 

## Version info and packages used
R version 4.3.1 (2023-06-16)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
<details>
<summary>loaded packages</summary>

- `abind` (1.4-5)
- `AnnotationDbi` (1.62.2)
- `babelgene` (22.9)
- `backports` (1.4.1)
- `beeswarm` (0.4.0)
- `Biobase` (2.60.0)
- `BiocFileCache` (2.8.0)
- `BiocGenerics` (0.46.0)
- `biomaRt` (2.56.1)
- `Biostrings` (2.68.1)
- `bit` (4.0.5)
- `bit64` (4.0.5)
- `bitops` (1.0-7)
- `blob` (1.2.4)
- `boot` (1.3-28.1)
- `broom` (1.0.5)
- `cachem` (1.0.8)
- `car` (3.1-2)
- `carData` (3.0-5)
- `circlize` (0.4.15)
- `cli` (3.6.1)
- `clue` (0.3-64)
- `cluster` (2.1.4)
- `codetools` (0.2-19)
- `colorspace` (2.1-0)
- `compiler` (4.3.1)
- `ComplexHeatmap` (2.16.0)
- `crayon` (1.5.2)
- `curl` (5.0.1)
- `data.table` (1.14.8)
- `DBI` (1.1.3)
- `dbplyr` (2.3.4)
- `decoupleR` (2.6.0)
- `digest` (0.6.33)
- `doParallel` (1.0.17)
- `dplyr` (1.1.2)
- `ecole` (0.9-2021)
- `edgeR` (3.42.4)
- `ellipsis` (0.3.2)
- `fansi` (1.0.4)
- `fastmap` (1.1.1)
- `filelock` (1.0.2)
- `forcats` (1.0.0)
- `foreach` (1.5.2)
- `generics` (0.1.3)
- `GenomeInfoDb` (1.36.1)
- `GenomeInfoDbData` (1.2.10)
- `GetoptLong` (1.0.5)
- `GGally` (2.2.0)
- `ggbeeswarm` (0.7.2)
- `ggExtra` (0.10.0)
- `gghalves` (0.1.4)
- `ggplot2` (3.4.4)
- `ggpubr` (0.6.0)
- `ggrepel` (0.9.3)
- `ggsignif` (0.6.4)
- `ggstats` (0.5.0)
- `GlobalOptions` (0.1.2)
- `glue` (1.6.2)
- `gridExtra` (2.3)
- `gtable` (0.3.4)
- `here` (1.0.1)
- `hms` (1.1.3)
- `htmltools` (0.5.5)
- `httpuv` (1.6.11)
- `httr` (1.4.6)
- `IRanges` (2.34.1)
- `iterators` (1.0.14)
- `jsonlite` (1.8.7)
- `KEGGREST` (1.40.0)
- `km.ci` (0.5-6)
- `KMsurv` (0.1-5)
- `knitr` (1.44)
- `labdsv` (2.1-0)
- `later` (1.3.1)
- `lattice` (0.21-8)
- `lifecycle` (1.0.3)
- `limma` (3.56.2)
- `lme4` (1.1-34)
- `lmerTest` (3.1-3)
- `locfit` (1.5-9.8)
- `lubridate` (1.9.2)
- `magrittr` (2.0.3)
- `MASS` (7.3-60)
- `Matrix` (1.6-0)
- `matrixStats` (1.0.0)
- `memoise` (2.0.1)
- `mgcv` (1.9-0)
- `mime` (0.12)
- `miniUI` (0.1.1.1)
- `minqa` (1.2.5)
- `msigdbr` (7.5.1)
- `munsell` (0.5.0)
- `nlme` (3.1-162)
- `nloptr` (2.0.3)
- `numDeriv` (2016.8-1.1)
- `patchwork` (1.1.2)
- `pbapply` (1.7-2)
- `permute` (0.9-7)
- `pillar` (1.9.0)
- `pkgconfig` (2.0.3)
- `plyr` (1.8.8)
- `png` (0.1-8)
- `prettyunits` (1.2.0)
- `progress` (1.2.2)
- `promises` (1.2.0.1)
- `purrr` (1.0.1)
- `R6` (2.5.1)
- `rappdirs` (0.3.3)
- `RColorBrewer` (1.1-3)
- `Rcpp` (1.0.11)
- `RCurl` (1.98-1.12)
- `readr` (2.1.4)
- `rentrez` (1.2.3)
- `rjson` (0.2.21)
- `rlang` (1.1.1)
- `rprojroot` (2.0.3)
- `RSQLite` (2.3.1)
- `rstatix` (0.7.2)
- `Rtsne` (0.16)
- `S4Vectors` (0.38.1)
- `scales` (1.2.1)
- `shape` (1.4.6)
- `shiny` (1.7.5.1)
- `splines` (4.3.1)
- `stats4` (4.3.1)
- `stringi` (1.7.12)
- `stringr` (1.5.0)
- `survival` (3.5-5)
- `survminer` (0.4.9)
- `survMisc` (0.5.6)
- `tibble` (3.2.1)
- `tidyr` (1.3.0)
- `tidyselect` (1.2.0)
- `tidyverse` (2.0.0)
- `timechange` (0.2.0)
- `tools` (4.3.1)
- `tzdb` (0.4.0)
- `utf8` (1.2.3)
- `vctrs` (0.6.3)
- `vegan` (2.6-4)
- `vipor` (0.4.5)
- `withr` (2.5.1)
- `xfun` (0.39)
- `XML` (3.99-0.14)
- `xml2` (1.3.5)
- `xtable` (1.8-4)
- `XVector` (0.40.0)
- `yaml` (2.3.7)
- `zlibbioc` (1.46.0)
- `zoo` (1.8-12)


</details>